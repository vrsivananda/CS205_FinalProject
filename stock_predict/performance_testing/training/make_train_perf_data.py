import json

# ------------------ Single Node ------------------

single_node = {'bs_32': {},
               'bs_64': {},
               'bs_96': {},
               'bs_128': {}}

# batch size 32
single_node['bs_32']['time_per_epoch'] = [152,148,148,148,148,148,148,148,149,153,149,149,154,148,148,148,148,149,154,148]
single_node['bs_32']['train_loss'] = [4.350886956672184e-05, 1.8156773876398802e-05, 1.372255246678833e-05, 9.831012903305236e-06, 7.596098839712795e-06, 6.076755653339205e-06, 4.817452008865075e-06, 3.991536232206272e-06, 3.5268540159449913e-06, 2.627129106258508e-06, 2.4838832359819207e-06, 2.10846906156803e-06, 2.1206549263297347e-06, 2.1104694951645797e-06, 1.910791297632386e-06, 1.8226950260213926e-06, 1.6335314967363956e-06, 1.5301970961445477e-06, 1.6600311028014403e-06, 1.4768669416298508e-06]
single_node['bs_32']['val_loss'] = [5.750588343289564e-07, 1.9427632196311606e-06, 4.605796675605234e-06, 5.426015832199482e-06, 7.888695108704269e-06, 9.469507858739235e-06, 2.006291651923675e-05, 1.9681145204231143e-05, 2.267800118715968e-05, 2.577437953732442e-05, 2.5464203645242378e-05, 3.4042459446936846e-05, 3.2889693102333695e-05, 3.657382694655098e-05, 4.16283291997388e-05, 4.899883788311854e-05, 4.6869998186593875e-05, 4.165438440395519e-05, 5.7227258366765454e-05, 6.043685061740689e-05]
single_node['bs_32']['test_loss'] = 0.00015601

# batch size 64
single_node['bs_64']['time_per_epoch'] = [76,71,71,70,71,70,71,71,71,71,71,71,70,70,71,71,71,71,71,71]
single_node['bs_64']['train_loss'] = [6.902616587467492e-05, 2.2329271814669482e-05, 1.9217817680328153e-05, 1.831698500609491e-05, 1.613776112208143e-05, 1.4207058484316804e-05, 1.257746134797344e-05, 1.0682522770366631e-05, 8.4138073361828e-06, 7.010468834778294e-06, 5.418636646936648e-06, 4.494917448027991e-06, 3.6941073631169274e-06, 3.0084736408753088e-06, 2.4804937766020885e-06, 2.402970039838692e-06, 2.022449734795373e-06, 1.7317743186140433e-06, 1.562822944833897e-06, 1.5502234873565612e-06]
single_node['bs_64']['val_loss'] =  [1.6938399767241208e-06, 3.743421984836459e-06, 1.8570750626167865e-06, 8.039472731979913e-07, 2.207011220889399e-06, 2.831021220117691e-06, 2.0153265722910874e-06, 4.38237748312531e-06, 8.534359039913397e-06, 6.176565875648521e-06, 1.1108964827144518e-05, 1.3314281204657163e-05, 1.4712856682308484e-05, 2.1767446014564484e-05, 1.9513499864842743e-05, 2.610793490021024e-05, 2.9244314646348357e-05, 3.586512684705667e-05, 3.4587428672239184e-05, 4.216174784232862e-05]
single_node['bs_64']['test_loss'] = 0.00016358

# batch size 96
single_node['bs_96']['time_per_epoch'] = [54,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49]
single_node['bs_96']['train_loss'] = [8.460909884888679e-05, 2.1410991394077428e-05, 1.7235230188816786e-05, 1.5070114386617206e-05, 1.3796449820802081e-05, 1.1312016795272939e-05, 9.929904990713112e-06, 8.546108801965602e-06, 6.858972028567223e-06, 5.418301043391693e-06, 4.769972747453721e-06, 3.7172212614677846e-06, 3.475114681350533e-06, 2.843123638740508e-06, 2.7058463274443056e-06, 2.405651912340545e-06, 2.061802888420061e-06, 2.2407318738260074e-06, 1.7913735064212233e-06, 1.886279051177553e-06]
single_node['bs_96']['val_loss'] = [1.1823448176073725e-06, 1.1592071587074315e-06, 1.0404637578176335e-06, 1.1627338381003938e-06, 1.5704787301729084e-06, 1.1370177617209265e-06, 2.3230879833135987e-06, 3.226541821277351e-06, 5.4652587095915806e-06, 8.326139322889503e-06, 1.0933853445749264e-05, 1.7698081137496047e-05, 2.343690357520245e-05, 3.106598887825385e-05, 3.804760126513429e-05, 4.135515700909309e-05, 5.187558053876273e-05, 5.048725142842159e-05, 5.195734775043093e-05, 5.878213778487407e-05]
single_node['bs_96']['test_loss'] = 1.62E-04

# batch size 128
single_node['bs_128']['time_per_epoch'] = [43,37,38,37,38,38,38,37,37,37,38,38,37,38,33,37,37,37,38,37]
single_node['bs_128']['train_loss'] = [6.470516382250935e-05, 1.6739246348151937e-05, 1.300049916608259e-05, 1.118942782341037e-05, 9.297593351220712e-06, 8.301496563944966e-06, 7.058516985125607e-06, 6.071218649594812e-06, 5.1514662118279375e-06, 4.39604355051415e-06, 3.996252871729666e-06, 3.510540182105615e-06, 2.823421709763352e-06, 2.699421202123631e-06, 2.353597210458247e-06, 2.0602517452061875e-06, 2.0306799797253916e-06, 1.650403646635823e-06, 1.623217713131453e-06, 1.5107689250726253e-06]
single_node['bs_128']['val_loss'] =  [3.4210611374874134e-06, 4.872112185694277e-06, 1.1339350749040022e-05, 1.4133727745502256e-05, 1.5048332898004446e-05, 2.40176341321785e-05, 2.060133010672871e-05, 2.6010357032646425e-05, 2.9716695280512795e-05, 2.7717120246961713e-05, 2.4622482669656165e-05, 3.3044278097804636e-05, 3.631420258898288e-05, 4.43064454884734e-05, 4.3758369429269806e-05, 3.934812775696628e-05, 6.005012255627662e-05, 5.660580427502282e-05, 6.24731692369096e-05, 6.353947537718341e-05]
single_node['bs_128']['test_loss'] = 1.7961e-04



# ------------------ Multi Node ------------------

multi_node = {'1': {},
              '2': {},
              '3': {},
              '4': {}}

# 1 node
multi_node['1']['time_per_epoch'] = [152,148,148,148,148,148,148,148,149,153,149,149,154,148,148,148,148,149,154,148]
multi_node['1']['train_loss'] = [4.350886956672184e-05, 1.8156773876398802e-05, 1.372255246678833e-05, 9.831012903305236e-06, 7.596098839712795e-06, 6.076755653339205e-06, 4.817452008865075e-06, 3.991536232206272e-06, 3.5268540159449913e-06, 2.627129106258508e-06, 2.4838832359819207e-06, 2.10846906156803e-06, 2.1206549263297347e-06, 2.1104694951645797e-06, 1.910791297632386e-06, 1.8226950260213926e-06, 1.6335314967363956e-06, 1.5301970961445477e-06, 1.6600311028014403e-06, 1.4768669416298508e-06]
multi_node['1']['val_loss'] = [5.750588343289564e-07, 1.9427632196311606e-06, 4.605796675605234e-06, 5.426015832199482e-06, 7.888695108704269e-06, 9.469507858739235e-06, 2.006291651923675e-05, 1.9681145204231143e-05, 2.267800118715968e-05, 2.577437953732442e-05, 2.5464203645242378e-05, 3.4042459446936846e-05, 3.2889693102333695e-05, 3.657382694655098e-05, 4.16283291997388e-05, 4.899883788311854e-05, 4.6869998186593875e-05, 4.165438440395519e-05, 5.7227258366765454e-05, 6.043685061740689e-05]
multi_node['1']['test_loss'] = 0.00015601

# 2 nodes
multi_node['2']['time_per_epoch'] = [129,107,107,111,106,107,106,106,106,106,106,106,106,106,106,106,106,106,106,107]
multi_node['2']['train_loss'] =  [5.366942423279397e-05, 2.420517375867348e-05, 1.9926728782593273e-05, 1.523254923085915e-05, 1.154876736109145e-05, 9.509022675047163e-06, 6.56878228255664e-06, 5.758208317274693e-06, 4.957895271218149e-06, 4.665786491386825e-06, 3.842048499791417e-06, 3.5969530927104643e-06, 3.562740630513872e-06, 3.5565951748139923e-06, 3.308499117338215e-06, 2.946962240457651e-06, 2.8613710583158536e-06, 2.945076403193525e-06, 3.0150474685797235e-06, 2.6883963073487394e-06]
multi_node['2']['val_loss'] =  [9.541861345496727e-07, 6.004455826769117e-06, 6.1954165175848175e-06, 1.4839606592431664e-05, 1.5361341866082512e-05, 1.6821610188344494e-05, 3.427276169531979e-05, 4.1258808778366074e-05, 5.162052184459753e-05, 4.4194610381964594e-05, 6.582203786820173e-05, 5.271937698125839e-05, 6.053306060493924e-05, 6.88104482833296e-05, 7.936995098134503e-05, 7.033665315248072e-05, 7.322137389564887e-05, 6.916619895491749e-05, 7.029862172203138e-05, 7.617911614943296e-05]
multi_node['2']['test_loss'] = 0.00018526

# 3 nodes
multi_node['3']['time_per_epoch'] = [101,84,83,81,84,82,82,82,83,81,83,81,82,81,83,83,83,82,84,82]
multi_node['3']['train_loss'] = [7.268216722877696e-05, 3.129954347969033e-05, 2.861236862372607e-05, 2.5285864467150532e-05, 2.3446613340638578e-05, 2.1155947251827456e-05, 2.0068982848897576e-05, 1.9858805899275467e-05, 1.879553201433737e-05, 1.7074293282348663e-05, 1.4868185644445475e-05, 1.284665268030949e-05, 1.0041107998404186e-05, 8.355406862392556e-06, 7.843182174838148e-06, 7.149686098273378e-06, 6.779245723009808e-06, 6.431819656427251e-06, 5.939638867857866e-06, 5.339965355233289e-06]
multi_node['3']['val_loss'] =  [2.028318931479589e-06, 1.920034264912829e-06, 9.568862679998347e-08, 1.7567826944286935e-06, 1.6044816675275797e-06, 6.150422109385545e-07, 4.4114096908742795e-07, 1.2218264373586862e-06, 5.825953394378303e-06, 2.0213112748024287e-06, 5.231147497397615e-06, 3.7894506021984853e-06, 1.5716894949946436e-06, 3.1877657420409378e-06, 5.812810286442982e-06, 8.879349479684606e-06, 1.0329944416298531e-05, 9.835028322413564e-06, 1.0343012945668306e-05, 1.0992011084454134e-05]
multi_node['3']['test_loss'] = 0.000083796

# 4 nodes
multi_node['4']['time_per_epoch'] = [87,72,72,73,72,71,71,73,73,70,72,72,72,73,72,71,73,71,70,71]
multi_node['4']['train_loss'] = [8.717567106941715e-05, 3.458787614363246e-05, 2.93727898679208e-05, 2.4932860469562e-05, 2.3709544620942324e-05, 2.433893496345263e-05, 2.395310548308771e-05, 2.1143179765203968e-05, 1.8722470485954545e-05, 1.5628096662112512e-05, 1.1839737453556154e-05, 1.0405785360489972e-05, 9.827997928368859e-06, 8.599626198702026e-06, 8.5401570686372e-06, 6.596672392333858e-06, 6.360712632158538e-06, 5.3212474995234516e-06, 4.83987196275848e-06, 4.259457000443945e-06]
multi_node['4']['val_loss'] =  [2.387516587987193e-06, 8.795566827757284e-06, 3.6219112189428415e-06, 9.834578804657212e-07, 5.251112270343583e-06, 5.876419209016603e-07, 2.0104243958485313e-06, 1.3403215461949003e-06, 1.4939545280867605e-06, 2.206586486863671e-06, 1.3234710422693752e-05, 1.9276627426734194e-05, 2.2236503355088644e-05, 1.3695211237063631e-05, 2.6365709345554933e-05, 2.580374166427646e-05, 2.7928643248742446e-05, 2.6288897061022e-05, 3.0285807952168398e-05, 3.403774826438166e-05]
multi_node['4']['test_loss'] = 0.00013571



# ------------------ Multi GPU ------------------

multi_gpu = {'bs_32': {},
             'bs_64': {},
             'bs_128': {},
             'bs_256': {}}

# batch size 32
multi_gpu['bs_32']['time_per_epoch'] = [121,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117]
multi_gpu['bs_32']['train_loss'] = [1.91E-04,2.35E-05,1.85E-05,1.65E-05,1.41E-05,1.16E-05,9.17E-06,7.63E-06,6.37E-06,5.53E-06,5.50E-06,4.90E-06,4.20E-06,3.49E-06,3.29E-06,2.87E-06,2.73E-06,2.93E-06,2.46E-06,2.68E-06]
multi_gpu['bs_32']['val_loss'] = [1.82E-06,2.44E-07,3.03E-07,4.75E-07,5.81E-07,4.55E-07,1.09E-06,1.67E-07,3.99E-07,2.37E-07,7.43E-07,1.02E-06,4.76E-06,5.38E-06,1.06E-05,1.12E-05,1.36E-05,2.16E-05,2.77E-05,4.70E-05]
multi_gpu['bs_32']['test_loss'] = 0.00012151

# batch size 64
multi_gpu['bs_64']['time_per_epoch'] = [63,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58]
multi_gpu['bs_64']['train_loss'] = [3.21E-04,2.45E-05,2.11E-05,2.11E-05,1.81E-05,1.57E-05,1.37E-05,1.11E-05,8.78E-06,7.61E-06,6.65E-06,5.95E-06,5.47E-06,4.90E-06,4.26E-06,4.42E-06,4.20E-06,3.58E-06,3.55E-06,3.75E-06]
multi_gpu['bs_64']['val_loss'] = [1.22E-06,2.15E-07,5.57E-07,8.01E-07,1.46E-07,8.03E-07,4.92E-07,4.08E-07,2.98E-07,1.50E-07,2.22E-07,2.02E-07,6.76E-07,7.84E-07,1.79E-06,2.23E-06,3.11E-06,7.40E-06,7.39E-06,9.24E-06]
multi_gpu['bs_64']['test_loss'] = 0.0000871

# batch size 128
multi_gpu['bs_128']['time_per_epoch'] = [37,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32]
multi_gpu['bs_128']['train_loss'] = [3.13E-04,2.15E-05,1.87E-05,1.59E-05,1.33E-05,1.18E-05,1.08E-05,9.24E-06,8.16E-06,6.93E-06,5.95E-06,5.44E-06,4.41E-06,4.30E-06,3.79E-06,3.55E-06,3.32E-06,3.67E-06,2.82E-06,2.66E-06]
multi_gpu['bs_128']['val_loss'] = [1.06E-06,3.39E-06,3.06E-06,7.14E-06,1.07E-05,1.09E-05,1.39E-05,1.59E-05,2.14E-05,2.40E-05,3.25E-05,3.00E-05,3.74E-05,3.60E-05,4.34E-05,4.25E-05,4.44E-05,4.97E-05,5.33E-05,5.34E-05]
multi_gpu['bs_128']['test_loss'] = 0.000183

# batch size 256
multi_gpu['bs_256']['time_per_epoch'] = [24,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19]
multi_gpu['bs_256']['train_loss'] = [5.39E-04,2.93E-05,2.06E-05,2.10E-05,1.92E-05,1.79E-05,1.63E-05,1.53E-05,1.43E-05,1.31E-05,1.22E-05,9.87E-06,9.34E-06,8.08E-06,7.48E-06,6.90E-06,6.51E-06,5.81E-06,5.47E-06,5.43E-06]
multi_gpu['bs_256']['val_loss'] = [8.91E-07,4.05E-07,1.78E-06,1.31E-06,1.13E-06,1.51E-06,1.48E-06,9.77E-07,1.60E-06,3.44E-06,2.77E-06,3.26E-06,2.58E-06,2.80E-06,3.73E-06,7.31E-06,7.04E-06,7.37E-06,8.44E-06,8.58E-06]
multi_gpu['bs_256']['test_loss'] = 0.0000614

# ----------- Save the dictionaries --------
with open('single_node.txt', 'w') as outfile:
    json.dump(single_node, outfile)
    
with open('multi_node.txt', 'w') as outfile:
    json.dump(multi_node, outfile)
    
with open('multi_gpu.txt', 'w') as outfile:
    json.dump(multi_gpu, outfile)

print('Dictionaries saved.')
